# RUDN-ATI-schedule Bot

Бот для просмотра расписания занятий факультета АТИ РУДН.  
Поддерживаются:

- Выбор курса (1–6): для каждого курса используется свой файл Excel с расписанием (schedule1.xlsx, …, schedule6.xlsx) в папке `data`
- Выбор группы, времени оповещений, программы (ФГОС/МП) и, при необходимости, языка  
- Команды:  
  - **/start** – регистрация нового пользователя и выбор курса  
  - **/settings** – настройка группы, времени, программы и языка  
  - **/today**, **/tomorrow**, **/week** – просмотр расписания на сегодня, завтра и неделю  
  - **/subscribe** и **/unsubscribe** – подписка на ежедневные оповещения

## Установка и запуск

1. **Локально:**  
   - Установите зависимости:
     ```bash
     pip install -r requirements.txt
     ```
   - Создайте файл **.env** в корне с содержимым:
     ```env
     TOKEN=ваш_telegram_bot_токен
     CURRENT_WEEK_PARITY=even
     ```
   - Убедитесь, что папка `data` содержит файлы `schedule1.xlsx` … `schedule6.xlsx` и (при первом запуске) файл `users.json` (он создастся автоматически, если его нет).
   - Запустите бота:
     ```bash
     python src/bot.py
     ```

2. **Через Docker Compose:**  
   - Убедитесь, что **Dockerfile**, **docker-compose.yml**, **.dockerignore** и **.env** находятся в корневой директории.
   - Сборка и запуск:
     ```bash
     docker-compose down --volumes --remove-orphans
     docker-compose build --no-cache
     docker-compose up -d
     ```
   - Для просмотра логов:
     ```bash
     docker-compose logs -f
     ```

## Файлы, не попадающие в Git

- **.env** и папка **data** указаны в **.dockerignore** и **.gitignore**.  
- **.env** содержит чувствительные данные (токен и настройки) и копируется на сервер вручную (или через скрипт).  
- Папка **data** хранит файлы расписания и базу пользователей. Для синхронизации (например, для получения обновлённой базы с сервера) используйте `rsync` или `scp`.

## Скрипты для управления контейнером

Создайте файлы **start.sh** и **stop.sh** в корневой директории:

**start.sh:**
```bash
#!/bin/bash
set -e
docker-compose down --volumes --remove-orphans
docker-compose build --no-cache
docker-compose up -d
echo "Контейнер запущен."
```
Сделайте его исполняемым:
chmod +x start.sh

# Дополнительная информация
**База пользователей** хранится в data/users.json. Она не попадает в репозиторий, поэтому синхронизируйте её с сервером вручную (например, через rsync).
**Расписание** для каждого курса хранится в файлах schedule1.xlsx – schedule6.xlsx в папке data.
**Настройка оповещений**: команда /subscribe автоматически подписывает пользователя на оповещения в заданное время (по умолчанию, например, 20:00), которое можно изменить в /settings
